<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Code Editor with JSON Input/Output and ECharts</title>
    
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Handlebars.js for templating -->
    <script src="https://cdn.jsdelivr.net/npm/handlebars@4.7.7/dist/handlebars.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
        }
    </style>

</head>
<body>
    <div class="container">
        <h1>ESG Data Transformer & Visualizer</h1>
        
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="transformer">Transformer</button>
            <button class="tab" data-tab="charts">Charts</button>
            <button class="tab" data-tab="report">Report</button>
        </div>

        <!-- Transformer Tab -->
        <div id="transformer" class="tab-content active">
            <div class="editors-wrapper">
                <!-- JSON Input/Output Row -->
                <div class="json-row">
                    <div class="editor-container">
                        <div class="editor-header">
                            <div class="editor-label">JSON Input</div>
                            <button class="load-json-button" onclick="loadJSONData()">Load JSON</button>
                        </div>
                        <textarea id="json-input"></textarea>
                        <div id="json-error" class="error"></div>
                    </div>
                    <div class="editor-container">
                        <div class="editor-label">JSON Output</div>
                        <textarea id="json-output"></textarea>
                    </div>
                </div>

                <!-- Code Editor Row -->
                <div class="code-row">
                    <div class="editor-container" style="width: 100%;">
                        <div class="editor-label">JavaScript Code</div>
                        <textarea id="code"></textarea>
                        <button class="action-button" onclick="runJavaScript()">Run Code</button>
                    </div>
                </div>

                <!-- Execution Output Row -->
                <div class="output-row" id="execution-output">
                    <div id="execution-error" class="error"></div>
                    <div id="execution-info" class="info"></div>
                    <div id="execution-success" class="success"></div>
                </div>
            </div>
        </div>

        <!-- Charts Tab -->
        <div id="charts" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-wrapper">
                        <div class="chart-controls">
                            <button class="chart-config-btn" data-action="export" data-chart="timelineChart">Export Config</button>
                            <button class="chart-config-btn" data-action="import" data-chart="timelineChart">Import Config</button>
                            <button class="chart-config-btn" data-action="download" data-chart="timelineChart" data-filename="incidents-timeline">Download</button>
                        </div>
                        <div id="environmentalChart" class="chart-div"></div>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-wrapper">
                        <div class="chart-controls">
                            <button onclick="exportChartConfig('socialChart')">Export Config</button>
                            <button onclick="importChartConfig('socialChart')">Import Config</button>
                            <button onclick="downloadChart('socialChart', 'social-metrics')">Download</button>
                        </div>
                        <div id="socialChart" class="chart-div"></div>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-wrapper">
                        <div class="chart-controls">
                            <button onclick="exportChartConfig('radarChart')">Export Config</button>
                            <button onclick="importChartConfig('radarChart')">Import Config</button>
                            <button onclick="downloadChart('radarChart', 'esg-overview')">Download</button>
                        </div>
                        <div id="radarChart" class="chart-div"></div>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-wrapper">
                        <div class="chart-controls">
                            <button onclick="exportChartConfig('gaugeChart')">Export Config</button>
                            <button onclick="importChartConfig('gaugeChart')">Import Config</button>
                            <button onclick="downloadChart('gaugeChart', 'governance-status')">Download</button>
                        </div>
                        <div id="gaugeChart" class="chart-div"></div>
                    </div>
                </div>
                <div class="chart-container full-width">
                    <div class="chart-wrapper">
                        <div class="chart-controls">
                            <button class="chart-config-btn" data-action="export" data-chart="timelineChart">Export Config</button>
                            <button class="chart-config-btn" data-action="import" data-chart="timelineChart">Import Config</button>
                            <button class="chart-config-btn" data-action="download" data-chart="timelineChart" data-filename="incidents-timeline">Download</button>
                        </div>
                        <div id="timelineChart" class="chart-div"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Report Tab -->
        <div id="report" class="tab-content">
            <div class="report-container">
                <div class="report-editors">
                    <div class="editor-container">
                        <div class="editor-label">Template Data</div>
                        <pre id="template-data-display" style="background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; padding: 10px; margin-bottom: 10px; overflow: auto; font-family: monospace; font-size: 12px; max-height: 200px;"></pre>
                        <div class="editor-label">Markdown Template</div>
                        <textarea id="markdown-template"></textarea>
                    </div>
                    <div class="editor-container">
                        <div class="editor-label">Report Preview</div>
                        <div id="report-preview" class="report-preview">
                            <div class="preview-content"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configuration Modal -->
    <div id="configModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modalTitle">Chart Configuration</h2>
            <div id="configEditor" class="config-editor"></div>
            <button class="modal-button apply-config">Apply Configuration</button>
        </div>
    </div>

    <!-- CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/markdown/markdown.min.js"></script>
    
    <!-- Apache ECharts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>

    <!-- AWS SDK -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1001.0.min.js"></script>

    <!-- Our application code -->
    <script src="script.js"></script>
</body>
</html> 